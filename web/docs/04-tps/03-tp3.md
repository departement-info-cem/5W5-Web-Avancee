# TP3 (Super suite de Super Cartes Infinies)

TODO: Mentionner que la version d√©ploy√© va n√©cessit√© une mise √† jour pour fonctionner

## Le projet
Ajouter des fonctionnalit√©s au jeu de cartes d√©velopp√© lors du Sprint 1.

:::info
Vous devez choisir une des t√¢ches suivantes qui sera √©valuer de fa√ßon individuelle. Vous devez √©crire vous-m√™me le code, mais vous pouvez collaborer avec vos coll√®gues.
:::

### Les t√¢ches individuelles
:::warning
La t√¢che de pouvoirs suppl√©mentaires doit √™tre fait par un autre √©tudiant que celui qui a fait la logique de jeu au TP2
:::
- **\[Obligatoire\]** Pouvoirs suppl√©mentaires et cartes de sort
- Statistiques des joueurs
- Ranking et matchmaking
- Chat et mode spectateur

### Contraintes
- Le travail doit √™tre effectu√© en √©quipes de 3 ou 4.
- Vous devez utiliser **Git/GitHub**.
- Vous devez utiliser **DevOps** pour la gestion des t√¢ches ET utiliser les **sprints**.

### Les √©tapes et √©valuations
Il y a 2 √©valuations, mais il est fortement recommand√© de terminer les t√¢ches individuelles au moins une semaine avant la remise d'√©quipe :
- Premier livrable d'√©quipe (Premi√®re √©valuation)
- Fonctionnalit√©s individuelles
- Merge et derni√®re fonctionnalit√© (Deuxi√®me √©valuation)

## Premier livrable d'√©quipe (5%)
- Comme on va travailler en Test Driven Development (TDD). Il faut ajouter au moins un test complet pour chacun des nouveaux pouvoirs. (Voir la premi√®re t√¢che individuelle)
- Il faut ordonner les cartes sur le BattleField en [utilisant un Index](/info/DataOrder)
- Prot√®ger la branche de d√©veloppement avec des tests unitaires automatiques et au moins un review pour le Pull Request. (L'appliquer sur la branche o√π les diff√©rentes parties individuelles vont √™tre merg√©es)

## T√¢ches individuelles (11%)
:::warning
La t√¢che d'habilet√©s suppl√©mentaires doit √™tre fait par un autre √©tudiant que celui qui a fait la logique de jeu au TP2
:::
- Habilet√©s suppl√©mentaires [obligatoire] 
- Statistiques des joueurs
- Matchmaking
- Chat et mode spectateur



## Statistiques des joueurs
- Un joueur aura la possibilit√© de voir des statistiques √† propos de ses decks ou de l‚Äôensemble de ses cartes
    - Il pourra voir le nombre de victoire et d√©faites avec ce deck (ou g√©n√©ral)
    - La distribution des cartes (En utilisant des graphs similaires):
        - Co√ªt
        - Raret√©
        - Attaque et d√©fense
- Vous pouvez utiliser la technologie de graph que vous pr√©f√©rez, mais on propose la suivante : https://canvasjs.com/angular-charts/pie-chart-index-data-label/ 

### Lorsqu‚Äôon affiche l‚Äôensemble des cartes

|![alt text](/img/tps/tp3/image-1.png)|
|-|

### Lorsque l‚Äôon s√©lectionne un deck

|![alt text](/img/tps/tp3/image-2.png)|
|-|

‚ÄÉ
### Habilit√©s suppl√©mentaires
- Il y aura l‚Äôajout d‚Äôhabilit√©s pour les cartes qui vont modifier un √©tat. 
    - Poison X, qui ajoute une valeur de poison √† la carte attaqu√©e. Le poison diminue ensuite la vie d‚Äôune carte de la valeur du poison √† la fin de son activation. Si une carte a d√©j√† une valeur de poison et qu‚Äôelle est √† nouveau attaqu√©e, la valeur de poison est augment√©e.
    - Stunned X, qui emp√™che une carte d‚Äôagir pendant son activation durant X tours. (Mais elle re√ßoit quand m√™me les d√©g√¢ts de poison!)
    - Holy Shield, qui prot√®ge la carte en bloquant 100% des d√©g√¢ts la prochaine fois qu‚Äôelle en re√ßoit et disparait apr√®s.
**Modifier pour de v√©ritables cartes instantan√©es**
- Il y aura √©galement l‚Äôajout de cartes qui auront un effet imm√©diat et qui se d√©placeront directement dans le ¬´ graveyard ¬ª par la suite (On n‚Äôattend pas la fin du tour).
    - Lightning Strike X, fait X d√©g√¢ts au joueur adverse. (Attention, c‚Äôest possible que la partie se termine)
    - Earthquake X, fait X d√©g√¢ts √† TOUTES les cartes en jeu.
    - Magical Hammer X, fait X d√©g√¢ts √† une carte adverse.

**Boost de l'attaque des cartes**
**Ramener une carte du graveyard**
**Faire au moins un Power qui est full random et qui utilise un Mock pour les tests**



### Chat, Status (Content, Fach√©, Amus√©, etc), Mode spectateur

- Chat dans un menu sur le c√¥t√© avec les messages et la liste des gens pr√©sent (Les spectateurs peuvent √©crire aussi, mais les joueurs peuvent les banir de la partie)
  - On peut √©galement faire Mute, pour ne plus affiche les messages d'un joueur sur notre client pour cette partie
- Status avec 4 ou 5 ic√¥nes pour changer et une animation sur les 2 clients
- Liste des parties actives avec l'option de les regarder
- Voir seulement les cartes que l'on peut jouer de notre main? (avec un halo ou quelque chose) (Assez de Mana)

### Rankings ELO et Matchmaking

(Voir l'ancien document de TP3 (A23) qui √©tait trop long)
Faire aussi un syst√®me de matchmaking diff√©rent qui prend des joueurs avec un ELO plus loin du notre avec le temps
- Doit √©crire des tests pour ce syst√®me la aussi!
- Utiliser une **BACKGROUND TASK**
- Afficher aussi une page avec les meilleurs joueurs et une page avec les meilleurs joueurs pr√™t de nous
- Afficher le changement de ELO apr√®s chaque Match!

- 	Calculer son ELO (voir prochaine page) apr√®s chaque match et avoir un leaderboard (les 8 meilleurs joueurs et les 4 au-dessus et 3 en-dessous).
- 	Ajouter un seed avec au moins 10 joueurs qui ont des scores ELO diff√©rents
- 	Identifier l‚Äôutilisateur dans la liste de position (et celle des meilleurs joueurs, s‚Äôil en fait partie)
- 	Cas sp√©cial : si l‚Äôutilisateur est un des 5 meilleurs joueurs, le tableau de ¬´ Ta position ¬ª montre √©galement les 8 meilleures joueurs.
 

‚ÄÉ
Pour le calcul du score ELO, faites commencer les joueurs avec un score de 1000.
Par la suite, apr√®s chaque match, utiliser cette m√©thode pour calculer le nouveau score des 2 joueurs.

```csharp
public class EloCalculator
{
    public enum GameOutcome
    {
        Win = 1,
        Loss = 0
    }

    public static void CalculateELO(ref int p1Rating, ref int p2Rating, GameOutcome p1Outcome)
    {
        int eloK = 32;

        double expectation = ExpectationToWin(p1Rating, p2Rating);
        int delta = (int)(eloK * ((int)p1Outcome - expectation));

        p1Rating += delta;
        p2Rating -= delta;
    }

    private static double ExpectationToWin(int p1Rating, int p2Rating)
    {
        return 1 / (1 + Math.Pow(10, (p2Rating - p1Rating) / 400.0));
    }
}
```


## Partie Commune Finale (4%)
- Faire le merge des diff√©rentes partie
- Faire le d√©ploiement
- Fixer le probl√®me de mise √† jour du match (d√©tails √† venir!)

## Grille de correction
- 11% de la note pour l‚Äô√©valuation individuelle (voir le document sur la correction individuelle)
- 9% de la note pour l‚Äô√©valuation de groupe
    -	5% pour la premi√®re remise
    -	4% pour la remise final


<!--
## R√©f√©rence pour la remise finale en √©quipe

Une r√©f√©rence pour voir un client et un serveur fonctionnels.

- üîó[Client](https://wonderful-tree-0ccc8c610.4.azurestaticapps.net/)

:::info
Vous pouvez simplement utiliser register pour ajouter vos propres joueurs
:::

- üîó[Serveur](https://supercartesinfiniesTP2.azurewebsites.net/)

:::info
Username: admin@admin.com Le mot de passe: Passw0rd!
:::

:::danger
C'est possible que les exemples ne fonctionnent pas bien selon vos options de cookies. Nous allons les regarder en classe. Pour le truc: [Cookies](/info/Trucs#pour-accepter-les-cookies-third-parties)
:::
-->